---
title: "Wintermute Rekt"
date: "2024-02-14T14:27:00.000Z"
lastmod: "2024-02-14T17:10:00.000Z"
draft: false
featuredImage: "https://cdn.nodeguardians.io/backend-production/Wintermute_Rekt\
  _part1_1200px_66fcb9642f/Wintermute_Rekt_part1_1200px_66fcb9642f.webp"
weight: 2
difficulty: "ðŸ—¡ðŸ—¡ðŸ—¡ðŸ—¡ðŸ—¡"
language:
  - "Solidity"
next: "Cream-Finance-Rekt-04ac5f09eb5d42c0b28fcdd8aabdc19d"
level-url: "https://nodeguardians.io/dev-hub/quests/wintermute-rekt"
type: "docs"
skill-cat:
  - "Security"
state: "Done"
about:
  - "ctf"
prev: "Price-Oracle-Attack-48bb5fd1fcf5428e84266833aecafe4f"
NOTION_METADATA:
  object: "page"
  id: "d0fd4609-1479-41e6-af7f-cc68ef81da6a"
  created_time: "2024-02-14T14:27:00.000Z"
  last_edited_time: "2024-02-14T17:10:00.000Z"
  created_by:
    object: "user"
    id: "7866207c-089f-43df-9333-1dc33859c6a9"
  last_edited_by:
    object: "user"
    id: "7866207c-089f-43df-9333-1dc33859c6a9"
  cover:
    type: "external"
    external:
      url: "https://cdn.nodeguardians.io/backend-production/Wintermute_Rekt_part1_120\
        0px_66fcb9642f/Wintermute_Rekt_part1_1200px_66fcb9642f.webp"
  icon:
    type: "emoji"
    emoji: "âœ…"
  parent:
    type: "database_id"
    database_id: "67ccfb28-aa7e-4248-9272-3d9732e4a83e"
  archived: false
  properties:
    weight:
      id: "%3BQ%60q"
      type: "number"
      number: 2
    difficulty:
      id: "%3DCqv"
      type: "status"
      status:
        id: "}M?I"
        name: "ðŸ—¡ðŸ—¡ðŸ—¡ðŸ—¡ðŸ—¡"
        color: "purple"
    language:
      id: "Py%7Cy"
      type: "multi_select"
      multi_select:
        - id: "d01ac056-199f-4b78-96ee-583126c15462"
          name: "Solidity"
          color: "blue"
    next:
      id: "%60Q~a"
      type: "rich_text"
      rich_text:
        - type: "text"
          text:
            content: "Cream-Finance-Rekt-04ac5f09eb5d42c0b28fcdd8aabdc19d"
            link: null
          annotations:
            bold: false
            italic: false
            strikethrough: false
            underline: false
            code: false
            color: "default"
          plain_text: "Cream-Finance-Rekt-04ac5f09eb5d42c0b28fcdd8aabdc19d"
          href: null
    level-url:
      id: "cjvw"
      type: "url"
      url: "https://nodeguardians.io/dev-hub/quests/wintermute-rekt"
    type:
      id: "khE_"
      type: "select"
      select:
        id: "Qq?l"
        name: "docs"
        color: "default"
    skill-cat:
      id: "n%7CzF"
      type: "multi_select"
      multi_select:
        - id: "8fe662a4-5f8b-4be9-8013-c00b51082782"
          name: "Security"
          color: "green"
    state:
      id: "sW%3AG"
      type: "status"
      status:
        id: "372c6056-56a9-4d05-861f-a165f80174eb"
        name: "Done"
        color: "green"
    about:
      id: "vf%7DG"
      type: "multi_select"
      multi_select:
        - id: "8003f5ac-a320-4dd2-8d86-081c00f91f54"
          name: "ctf"
          color: "red"
    prev:
      id: "~LUC"
      type: "rich_text"
      rich_text:
        - type: "text"
          text:
            content: "Price-Oracle-Attack-48bb5fd1fcf5428e84266833aecafe4f"
            link: null
          annotations:
            bold: false
            italic: false
            strikethrough: false
            underline: false
            code: false
            color: "default"
          plain_text: "Price-Oracle-Attack-48bb5fd1fcf5428e84266833aecafe4f"
          href: null
    title:
      id: "title"
      type: "title"
      title:
        - type: "text"
          text:
            content: "Wintermute Rekt"
            link: null
          annotations:
            bold: true
            italic: false
            strikethrough: false
            underline: false
            code: false
            color: "default"
          plain_text: "Wintermute Rekt"
          href: null
  url: "https://www.notion.so/Wintermute-Rekt-d0fd4609147941e6af7fcc68ef81da6a"
  public_url: null
UPDATE_TIME: "2024-02-14T17:12:27.038Z"
EXPIRY_TIME: "2024-02-14T18:12:21.113Z"

---
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/katex.min.css" integrity="sha384-bYdxxUwYipFNohQlHt0bjN/LCpueqWz13HufFEV1SUatKs1cm4L6fFgCi1jT643X" crossorigin="anonymous">


[https://rekt.news/wintermute-rekt-2](https://rekt.news/wintermute-rekt-2/)


[bookmark](https://blog.1inch.io/a-vulnerability-disclosed-in-profanity-an-ethereum-vanity-address-tool/)


[bookmark](https://github.com/johguse/profanity/issues/61?ref=blog.1inch.io)


[https://www.reddit.com/r/ethfinance/comments/xjaq6t/it_took_the_wintermute_hacker_5_days_to_brute/](https://www.reddit.com/r/ethfinance/comments/xjaq6t/it_took_the_wintermute_hacker_5_days_to_brute/)


[link_preview](https://github.com/rebryk/profanity-brute-force)


[bookmark](https://medium.com/coinmonks/the-profanity-address-hack-how-are-vanity-addresses-generated-cce40ba5ed39)


![](https://prod-files-secure.s3.us-west-2.amazonaws.com/00345c33-b7f7-443a-aca8-598247fb6d93/6bb075f4-fbe6-47d6-9009-d08cefa8ab49/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45HZZMZUHI%2F20240214%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240214T171221Z&X-Amz-Expires=3600&X-Amz-Signature=9558c32778086457cecf4e4c9c19c39701c0c17f6f902b89643c886d9a08394e&X-Amz-SignedHeaders=host&x-id=GetObject)


![](https://prod-files-secure.s3.us-west-2.amazonaws.com/00345c33-b7f7-443a-aca8-598247fb6d93/5f896cbd-b61b-43fa-8bbd-e68c8e287de6/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45HZZMZUHI%2F20240214%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240214T171221Z&X-Amz-Expires=3600&X-Amz-Signature=625b3605a5f0e0f9ca0de41240870b9978fb2fdf88c2bc60a430e786496bc2ae&X-Amz-SignedHeaders=host&x-id=GetObject)


![](https://prod-files-secure.s3.us-west-2.amazonaws.com/00345c33-b7f7-443a-aca8-598247fb6d93/d8816adc-72fb-42a6-8d8f-0e8c61639ec2/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45HZZMZUHI%2F20240214%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240214T171221Z&X-Amz-Expires=3600&X-Amz-Signature=1800559816bcd581b1ec4c0a6751d477bfc523e7242e59e749a070ac30cfe6d4&X-Amz-SignedHeaders=host&x-id=GetObject)


[https://vast.ai/](https://vast.ai/)


![](https://prod-files-secure.s3.us-west-2.amazonaws.com/00345c33-b7f7-443a-aca8-598247fb6d93/df0e6e95-e2b1-40ae-a3be-74f6b1974daf/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45HZZMZUHI%2F20240214%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240214T171221Z&X-Amz-Expires=3600&X-Amz-Signature=1f1b3c94cbeb07d611847881de5edb43569810d2a1fd0697e92a3a3f10091e5b&X-Amz-SignedHeaders=host&x-id=GetObject)


```solidity
Returned Raw Transaction Hex :

0x02f86905250b0b825208949f188f410cc1e77b44681a3f51e24d6cf59b1676875e41f437fd16e580c080a089cd24d733f64fab49a48395f8ed0f96f5ee3dfb3938151e69ff196f8a1eb393a06a3ba4d5911bcfa44e7ad01353a95161a7d4db2778ed14fddda5113dda68706c
```


![](https://prod-files-secure.s3.us-west-2.amazonaws.com/00345c33-b7f7-443a-aca8-598247fb6d93/1897b71a-84d2-4668-ab07-846c21840b57/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45HZZMZUHI%2F20240214%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240214T171221Z&X-Amz-Expires=3600&X-Amz-Signature=fae371b30ee201e0e49e2c860f5f39e8751a1257a196a7c3fe53f9f558b92fc8&X-Amz-SignedHeaders=host&x-id=GetObject)


```python
import os
import web3
from dotenv import load_dotenv
from eth_account._utils.signing import extract_chain_id, to_standard_v, serializable_unsigned_transaction_from_dict
from eth_account._utils.legacy_transactions import ALLOWED_TRANSACTION_KEYS
from eth_account._utils.legacy_transactions import serializable_unsigned_transaction_from_dict

load_dotenv()

RPC_URL_GOERLI = os.getenv('RPC_URL_GOERLI')

w3 = web3.Web3(web3.HTTPProvider(RPC_URL_GOERLI))
tx = w3.eth.get_transaction(0x955ec71df3c338d5c8fe1376fb34de7299a955daab5ae270dbd8514a4e7d6bc0)

print(tx.hash)


s = w3.eth.account._keys.Signature(vrs=(
    to_standard_v(extract_chain_id(tx.v)[1]),
    w3.to_int(tx.r),
    w3.to_int(tx.s)
))

tt = {k:tx[k] for k in ALLOWED_TRANSACTION_KEYS - {'chainId', 'data'}}
tt['data']=tx.input
tt['chainId']=extract_chain_id(tx.v)[0]
ut = serializable_unsigned_transaction_from_dict(tt)
print(s.recover_public_key_from_msg_hash(ut.hash()))
print(s.recover_public_key_from_msg_hash(ut.hash()).to_checksum_address())
print(tx['from'])
```


```solidity
b'\x95^\xc7\x1d\xf3\xc38\xd5\xc8\xfe\x13v\xfb4\xder\x99\xa9U\xda\xabZ\xe2p\xdb\xd8QJN}k\xc0'
0x5dbbcb43e58d080753ea59b3fab255e585d26582c24238cd051fde579799775f58a580bbeefd317b7a0101548bb68260966c70afd6bbe82915abba6ca1c4a8ff
0xb877cBd3019AA3bEB24b6e1B03ee3aBBF6590711
0x0DEaD582fa84de81e5287132d70d9a296224Cf90
```


```python
const fs = require("node:fs");
const { BigNumber } = require("ethers");
const { arrayify, keccak256, zeroPad } = require("ethers/lib/utils");
const { CURVE } = require("@noble/secp256k1");

const MAX_UINT16 = 65535;
const K = "0xc01ddeadc01ddeadc01ddead";

const d0 = BigNumber.from(K).mul(0);
const d1 = BigNumber.from(K).mul(1);
const d2 = BigNumber.from(K).mul(2);

// Generates all possible private keys (65535 * 3 = 196 605)
for (let i = 0; i < MAX_UINT16; i++) {
  const privateKey = BigNumber.from(keccak256(i));

  const s0 = zeroPad(arrayify(privateKey.add(d0).mod(CURVE.n)), 32);
  const s1 = zeroPad(arrayify(privateKey.add(d1).mod(CURVE.n)), 32);
  const s2 = zeroPad(arrayify(privateKey.add(d2).mod(CURVE.n)), 32);

  const content = `${s0}\n${s1}\n${s2}\n`;

  fs.appendFileSync("out.log", content, (err) => {
    if (err) {
      console.error(err);
    }
  });
}
```


[https://blog.safeheron.com/blog/insights/safeheron-originals/a-deep-dive-of-how-profanity-caused-wintermute-to-lose-usd160m](https://blog.safeheron.com/blog/insights/safeheron-originals/a-deep-dive-of-how-profanity-caused-wintermute-to-lose-usd160m)


![](https://prod-files-secure.s3.us-west-2.amazonaws.com/00345c33-b7f7-443a-aca8-598247fb6d93/2ef5764e-eb17-415f-9411-64d0ac450ec1/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45HZZMZUHI%2F20240214%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240214T171221Z&X-Amz-Expires=3600&X-Amz-Signature=c8d3734c6da3235afb9058192164b26ad3de9e0d77123145bfe4d67ba47622c1&X-Amz-SignedHeaders=host&x-id=GetObject)


[bookmark](https://ethereum.stackexchange.com/questions/13778/get-public-key-of-any-ethereum-account)


![](https://prod-files-secure.s3.us-west-2.amazonaws.com/00345c33-b7f7-443a-aca8-598247fb6d93/932426b9-1f57-47b7-aab6-18bff19f1360/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45HZZMZUHI%2F20240214%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240214T171221Z&X-Amz-Expires=3600&X-Amz-Signature=90bd6cc67993519b74dd6c92d271983202008243188f6bcdcc7bfc9ad2d4ef55&X-Amz-SignedHeaders=host&x-id=GetObject)


[bookmark](https://toolkit.abdk.consulting/ethereum#recover-address)


![](https://prod-files-secure.s3.us-west-2.amazonaws.com/00345c33-b7f7-443a-aca8-598247fb6d93/79b5b115-1e41-4144-ab22-492a91367fe7/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45HZZMZUHI%2F20240214%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240214T171221Z&X-Amz-Expires=3600&X-Amz-Signature=f2d568c1a6c3b73e8d9bf53ee2dc69d937ad5e253dc4f9bbc7335ce4900b887c&X-Amz-SignedHeaders=host&x-id=GetObject)


```python
0x042c4220f430b1b624e1441d1a0c1849f13b28c43d87fb828cb3330fab2543365b04dfe6a714c0f91515db6e8ac8e86683bf98f3aa98a4ccdcc3f5676f252d515b
```


```python
X = 2c4220f430b1b624e1441d1a0c1849f13b28c43d87fb828cb3330fab2543365b
Y = 04dfe6a714c0f91515db6e8ac8e86683bf98f3aa98a4ccdcc3f5676f252d515b
```


[https://stackoverflow.com/questions/57802131/can-we-generate-public-key-from-ethereum-public-address](https://stackoverflow.com/questions/57802131/can-we-generate-public-key-from-ethereum-public-address)


```bash
Tx = 0x02f87105808459682f0085015de996e482520894a73db9cfb00f43241f35d6462124c11b72c765cf865af3107a400080c001a014ad83bdfc9bb697562faf6fd876b3fcda0e08bfc91589ad7e140d6e6f7f2138a036c1ad13b175a65fc23749d201fa382b5169e4f0ca0bbc041140077e19e4c803
From = 0x0DEaD582fa84de81e5287132d70d9a296224Cf90
To = 0xA73dB9CFB00F43241f35d6462124C11B72C765CF
r = 0x14ad83bdfc9bb697562faf6fd876b3fcda0e08bfc91589ad7e140d6e6f7f2138
s = 0x36c1ad13b175a65fc23749d201fa382b5169e4f0ca0bbc041140077e19e4c803
v = 0xf81d53b9d2fa44bb0c31913b55eeabf38492d187fc2fe162a6359850c2320b97
```


![](https://prod-files-secure.s3.us-west-2.amazonaws.com/00345c33-b7f7-443a-aca8-598247fb6d93/0cb37632-2928-440c-96c3-8bba3f1c7666/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45HZZMZUHI%2F20240214%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240214T171221Z&X-Amz-Expires=3600&X-Amz-Signature=42f3b3d707853f1253ad66162adef39121404e5ea99e80c8f1523fdc64a2f5be&X-Amz-SignedHeaders=host&x-id=GetObject)


[https://cryptobook.nakov.com/digital-signatures/ecdsa-sign-verify-messages](https://cryptobook.nakov.com/digital-signatures/ecdsa-sign-verify-messages)


[https://scrapbox.io/piyopiyo/How_to_get_senderâ€™s_Ethereum_address_and_public_key_from_signed_transaction](https://scrapbox.io/piyopiyo/How_to_get_sender%E2%80%99s_Ethereum_address_and_public_key_from_signed_transaction)


[https://ethereum.stackexchange.com/questions/78815/ethers-js-recover-public-key-from-contract-deployment-via-v-r-s-values](https://ethereum.stackexchange.com/questions/78815/ethers-js-recover-public-key-from-contract-deployment-via-v-r-s-values)


```javascript
const { ethers } = require("ethers");

async function recover(tx) {
  const expandedSig = {
    r: tx.r,
    s: tx.s,
    v: tx.v,
  };

  const signature = ethers.utils.joinSignature(expandedSig);

  const txData = {
    gasLimit: tx.gasLimit,
    value: tx.value,
    nonce: tx.nonce,
    data: tx.data,
    chainId: tx.chainId,
    to: tx.to, // you might need to include this if it's a regular tx and not simply a contract deployment
    type: tx.type,
    maxFeePerGas: tx.maxFeePerGas,
    maxPriorityFeePerGas: tx.maxPriorityFeePerGas,
  };

  const rsTx = await ethers.utils.resolveProperties(txData);
  const raw = ethers.utils.serializeTransaction(rsTx); // returns RLP encoded tx
  const msgHash = ethers.utils.keccak256(raw); // as specified by ECDSA
  const msgBytes = ethers.utils.arrayify(msgHash); // create binary hash

  return {
    publicKey: ethers.utils.recoverPublicKey(msgBytes, signature),
    address: ethers.utils.recoverAddress(msgBytes, signature),
  };
}

recover({
  r: "0x14ad83bdfc9bb697562faf6fd876b3fcda0e08bfc91589ad7e140d6e6f7f2138",
  s: "0x36c1ad13b175a65fc23749d201fa382b5169e4f0ca0bbc041140077e19e4c803",
  v: "0xf81d53b9d2fa44bb0c31913b55eeabf38492d187fc2fe162a6359850c2320b97",
  gasLimit: 21000,
  nonce: 0,
  value: 100000000000000,
  data: "",
  chainId: 5,
  to: "0xA73dB9CFB00F43241f35d6462124C11B72C765CF",
  type: 2,
  maxFeePerGas: 5870556900,
  maxPriorityFeePerGas: 1500000000,
}).then((res) => console.log(res));
```


```javascript
{
  publicKey: '0x04077029792b56144069fac2787ca35fad37f7f0634236ba02e307bff5a2f120e1c1484a687dc468e671eef339d1437d02d51949973ccfd29f33efe9aa4b9a6017',
  address: '0x0DEaD582fa84de81e5287132d70d9a296224Cf90'
}
```


```javascript
const { BigNumber } = require("ethers");
const { Point } = require("@noble/secp256k1");
const {
  getAddress: checksumAddress,
  hexDataSlice,
  keccak256,
} = require("ethers/lib/utils");

console.log("Loading pub/priv key pairs into memory...");

const { data: map } = require("./map.js");

console.log("Data keys has been loaded");

let newPoint = Point.fromHex(
  "04077029792b56144069fac2787ca35fad37f7f0634236ba02e307bff5a2f120e1c1484a687dc468e671eef339d1437d02d51949973ccfd29f33efe9aa4b9a6017",
);

for (let i = 1; ; i++) {
  newPoint = newPoint.subtract(Point.BASE); // part of the set of the candidate pub key
  const hexNewPoint = newPoint.toHex();
  if (map[hexNewPoint] !== undefined) {
    const seedKey = new Uint8Array(map[hexNewPoint]);
    console.log(seedKey);
    const deadKey = BigNumber.from(seedKey).add(i);

    console.log(
      `i = ${i}\nPrivate Key: ${deadKey.toHexString()}\nPublic key: ${hexNewPoint}`,
    );
    break;
  }
}
```


![](https://prod-files-secure.s3.us-west-2.amazonaws.com/00345c33-b7f7-443a-aca8-598247fb6d93/a4dca9c4-5f68-4844-b2e8-63b0b6ae98c9/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45HZZMZUHI%2F20240214%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240214T171221Z&X-Amz-Expires=3600&X-Amz-Signature=20399eb518f2297c8cf1bf206e147129306d200ae81d01ce91fdbfd8a36811aa&X-Amz-SignedHeaders=host&x-id=GetObject)

